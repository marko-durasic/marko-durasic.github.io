<!-- Page View Tracker -->
<!-- Configure the API URL for your tracking endpoint -->
{% if site.analytics.page_tracker_url %}
<script>
  window.PageTracker = {
    apiUrl: '{{ site.analytics.page_tracker_url }}',
    respectDNT: true,
    debug: {{ site.analytics.page_tracker_debug | default: false }}
  };
</script>
<script defer>
/**
 * Lightweight Page-View Tracker (inline minified)
 */
(function(){"use strict";var e={apiUrl:null,sessionDuration:18e5,storageKey:"_pv_session",respectDNT:!0,debug:!1};if("object"==typeof window.PageTracker)for(var t in window.PageTracker)window.PageTracker.hasOwnProperty(t)&&(e[t]=window.PageTracker[t]);function n(){for(var e="abcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<16;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return Date.now().toString(36)+"-"+t}function a(){var t=null;try{var a=localStorage.getItem(e.storageKey);a&&(t=JSON.parse(a))}catch(e){}var r=Date.now();if(t&&t.id&&t.lastActive){if(r-t.lastActive<e.sessionDuration)return t.lastActive=r,function(){try{localStorage.setItem(e.storageKey,JSON.stringify(t))}catch(e){}}(),t.id}var o={id:n(),lastActive:r};try{localStorage.setItem(e.storageKey,JSON.stringify(o))}catch(e){}return o.id}function r(){return window.location.pathname+window.location.search}function o(t){var n={path:t||r(),referrer:document.referrer||null,userAgent:navigator.userAgent,timestamp:(new Date).toISOString(),sessionId:a(),viewportWidth:window.innerWidth,viewportHeight:window.innerHeight};if(e.debug&&console.log("[PageTracker] Tracking:",n),navigator.sendBeacon)try{var o=new Blob([JSON.stringify(n)],{type:"application/json"});if(navigator.sendBeacon(e.apiUrl,o))return}catch(e){}try{fetch(e.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0,mode:"cors",credentials:"omit"}).catch(function(){})}catch(e){}}if(!e.apiUrl)return;if(e.respectDNT&&("1"===navigator.doNotTrack||"1"===window.doNotTrack))return;var i=null;function s(){var e=r();e!==i&&(i=e,o(e))}"complete"===document.readyState?s():window.addEventListener("load",s);var c=history.pushState;history.pushState=function(){c.apply(history,arguments),setTimeout(s,0)};var d=history.replaceState;history.replaceState=function(){d.apply(history,arguments),setTimeout(s,0)},window.addEventListener("popstate",function(){setTimeout(s,0)}),window.addEventListener("hashchange",function(){setTimeout(s,0)}),window.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&a()}),window.PageTracker=window.PageTracker||{},window.PageTracker.track=o,window.PageTracker.config=e})();
</script>
{% endif %}
