/**
 * Lightweight Page-View Tracker (minified)
 * See tracker.js for full documentation
 */
(function(){"use strict";var e={apiUrl:null,sessionDuration:18e5,storageKey:"_pv_session",respectDNT:!0,debug:!1};if("object"==typeof window.PageTracker)for(var t in window.PageTracker)window.PageTracker.hasOwnProperty(t)&&(e[t]=window.PageTracker[t]);function n(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var n=e[t].src||"";if(-1!==n.indexOf("tracker.js")||-1!==n.indexOf("tracker.min.js")){var r=e[t].getAttribute("data-api");if(r)return r}}return null}function r(){for(var e="abcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<16;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return Date.now().toString(36)+"-"+t}function a(){var t=null;try{var n=localStorage.getItem(e.storageKey);n&&(t=JSON.parse(n))}catch(e){}var a=Date.now();if(t&&t.id&&t.lastActive){if(a-t.lastActive<e.sessionDuration)return t.lastActive=a,function(){try{localStorage.setItem(e.storageKey,JSON.stringify(t))}catch(e){}}(),t.id}var o={id:r(),lastActive:a};try{localStorage.setItem(e.storageKey,JSON.stringify(o))}catch(e){}return o.id}function o(){return window.location.pathname+window.location.search+window.location.hash}function i(t,n){var r=void 0!==n?n:document.referrer||null,s={path:t||o(),referrer:r,userAgent:navigator.userAgent,timestamp:(new Date).toISOString(),sessionId:a(),viewportWidth:window.innerWidth,viewportHeight:window.innerHeight};if(e.debug&&console.log("[PageTracker] Tracking:",s),navigator.sendBeacon)try{var c=new Blob([JSON.stringify(s)],{type:"application/json"});if(navigator.sendBeacon(e.apiUrl,c))return}catch(e){}try{fetch(e.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),keepalive:!0,mode:"cors",credentials:"omit"}).catch(function(){})}catch(e){}}if(e.apiUrl||(e.apiUrl=n()),!e.apiUrl)return void(e.debug&&console.warn("[PageTracker] No API URL configured"));if(e.respectDNT&&("1"===navigator.doNotTrack||"1"===window.doNotTrack))return void(e.debug&&console.log("[PageTracker] Respecting Do Not Track preference"));var s=null,c=document.referrer||null;function d(){var e=o();if(e!==s){var t=s||c;i(e,t),s=e}}"complete"===document.readyState?d():window.addEventListener("load",d);var l=history.pushState;history.pushState=function(){l.apply(history,arguments),setTimeout(d,0)};var u=history.replaceState;history.replaceState=function(){u.apply(history,arguments),setTimeout(d,0)},window.addEventListener("popstate",function(){setTimeout(d,0)}),window.addEventListener("hashchange",function(){setTimeout(d,0)}),window.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&a()}),window.PageTracker=window.PageTracker||{},window.PageTracker.track=i,window.PageTracker.config=e})();
