/**
 * Lightweight Page-View Tracker (minified)
 * See tracker.js for full documentation
 */
(function(){"use strict";var e={apiUrl:null,sessionDuration:18e5,storageKey:"_pv_session",respectDNT:!0,debug:!1};if("object"==typeof window.PageTracker)for(var t in window.PageTracker)window.PageTracker.hasOwnProperty(t)&&(e[t]=window.PageTracker[t]);function n(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var n=e[t].src||"";if(-1!==n.indexOf("tracker.js")||-1!==n.indexOf("tracker.min.js")){var a=e[t].getAttribute("data-api");if(a)return a}}return null}function a(){for(var e="abcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<16;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return Date.now().toString(36)+"-"+t}function r(){var t=null;try{var n=localStorage.getItem(e.storageKey);n&&(t=JSON.parse(n))}catch(e){}var r=Date.now();if(t&&t.id&&t.lastActive){if(r-t.lastActive<e.sessionDuration)return t.lastActive=r,function(){try{localStorage.setItem(e.storageKey,JSON.stringify(t))}catch(e){}}(),t.id}var o={id:a(),lastActive:r};try{localStorage.setItem(e.storageKey,JSON.stringify(o))}catch(e){}return o.id}function o(){return window.location.pathname+window.location.search}function i(t){var n={path:t||o(),referrer:document.referrer||null,userAgent:navigator.userAgent,timestamp:(new Date).toISOString(),sessionId:r(),viewportWidth:window.innerWidth,viewportHeight:window.innerHeight};if(e.debug&&console.log("[PageTracker] Tracking:",n),navigator.sendBeacon)try{var a=new Blob([JSON.stringify(n)],{type:"application/json"});if(navigator.sendBeacon(e.apiUrl,a))return}catch(e){}try{fetch(e.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0,mode:"cors",credentials:"omit"}).catch(function(){})}catch(e){}}if(e.apiUrl||(e.apiUrl=n()),!e.apiUrl)return void(e.debug&&console.warn("[PageTracker] No API URL configured"));if(e.respectDNT&&("1"===navigator.doNotTrack||"1"===window.doNotTrack))return void(e.debug&&console.log("[PageTracker] Respecting Do Not Track preference"));var s=null;function c(){var e=o();e!==s&&(s=e,i(e))}"complete"===document.readyState?c():window.addEventListener("load",c);var d=history.pushState;history.pushState=function(){d.apply(history,arguments),setTimeout(c,0)};var l=history.replaceState;history.replaceState=function(){l.apply(history,arguments),setTimeout(c,0)},window.addEventListener("popstate",function(){setTimeout(c,0)}),window.addEventListener("hashchange",function(){setTimeout(c,0)}),window.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&r()}),window.PageTracker=window.PageTracker||{},window.PageTracker.track=i,window.PageTracker.config=e})();
